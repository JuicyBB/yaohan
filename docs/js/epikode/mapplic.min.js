/*! epikode v1.0.0 | (c) 2022  | ISC License | http://github.com/your-username/project */
!(function(t){"use strict";var i=function(i){function e(){this.el=null,this.pin=null,this.shift=6,this.drop=0,this.location=null,this.init=function(){return this.el=t("<div></div>").addClass("mapplic-tooltip"),this.wrap=t("<div></div>").addClass("mapplic-tooltip-wrap").appendTo(this.el),this.close=t("<a></a>").addClass("mapplic-tooltip-close").attr("href","#").appendTo(this.wrap),this.close.on("click touchend",(function(t){t.preventDefault(),f.hideLocation(),f.o.zoom&&!f.o.zoomoutclose||f.moveTo(.5,.5,f.fitscale,400)})),this.image=t("<img>").addClass("mapplic-image").hide().appendTo(this.wrap),this.title=t("<h4></h4>").addClass("mapplic-tooltip-title").appendTo(this.wrap),this.content=t("<div></div>").addClass("mapplic-tooltip-content").appendTo(this.wrap),this.desc=t("<div></div>").addClass("mapplic-tooltip-description").appendTo(this.content),this.link=t("<a>"+f.loc.more+"</a>").addClass("mapplic-popup-link").attr("href","#").hide().appendTo(this.wrap),f.o.linknewtab&&this.link.attr("target","_blank"),this.triangle=t("<div></div>").addClass("mapplic-tooltip-triangle").prependTo(this.wrap),f.map.append(this.el),this},this.show=function(i){if(i){var e=this;if(this.location=i,f.hovertip&&f.hovertip.hide(),i.image?(this.el.addClass("has-image"),this.image.attr("src",""),this.image.attr("src",i.image).show()):(this.el.removeClass("has-image"),this.image.hide()),i.link){this.link.attr("href",i.link).css("background-color","").show();var a=b(i);a&&this.link.css("background-color",a)}else this.link.hide();this.title.text(i.title),i.description?this.desc.html(i.description):this.desc.empty(),this.content[0].scrollTop=0,this.pin=t('.mapplic-pin[data-location="'+i.id+'"]'),0==this.pin.length?this.shift=20:this.shift=Math.abs(parseFloat(this.pin.css("margin-top")))+20,t("img",this.el).off("load").on("load",(function(){e.position(),f.o.zoom&&e.zoom(i)})),this.position(),this.el.stop().css({opacity:1}).show(),f.o.zoom&&this.zoom(i)}},this.position=function(){this.location&&(this.el.css({left:100*this.location.x+"%",top:100*this.location.y+"%"}),this.drop=this.el.outerHeight()+this.shift)},this.zoom=function(t){var i=.5,e=t.zoom?parseFloat(t.zoom):f.o.maxscale;i=((f.container.el.height()-this.drop)/2+this.drop)/f.container.el.height(),f.moveTo(t.x,t.y,e,600,i)},this.hide=function(){var t=this;this.location=null,this.el.stop().fadeOut(300,(function(){t.desc&&t.desc.empty()}))},this.limitSize=function(){this.el.css("max-width",""),this.content.css("max-height","");var t=f.container.el.width()-100,i=f.container.el.height()-140;t<parseFloat(this.el.css("max-width"))&&this.el.css("max-width",t+"px"),i<parseFloat(this.content.css("max-height"))&&this.content.css("max-height",i+"px")}}function a(){this.el=null,this.init=function(){return this.el=t("<div></div>").addClass("mapplic-lightbox mfp-hide"),this.title=t("<h2></h2>").addClass("mapplic-lightbox-title").appendTo(this.el),this.desc=t("<div></div>").addClass("mapplic-lightbox-description").appendTo(this.el),this.link=t("<a>"+f.loc.more+"</a>").addClass("mapplic-popup-link").attr("href","#").hide().appendTo(this.el),f.o.linknewtab&&this.link.attr("target","_blank"),f.el.append(this.el),this},this.show=function(i){if(this.location=i,this.title.text(i.title),this.desc.html(i.description),i.link){this.link.attr("href",i.link).css("background-color","").show();var e=b(i);e&&this.link.css("background-color",e)}else this.link.hide();var a=this;t.magnificPopup.open({items:{src:this.el},type:"inline",removalDelay:300,mainClass:"mfp-fade",callbacks:{beforeClose:function(){a.hide()}}});var o=i.zoom?parseFloat(i.zoom):f.o.maxscale;f.o.zoom&&f.moveTo(i.x,i.y,o,600),f.tooltip&&f.tooltip.hide()},this.showImage=function(i){this.location=i;var e=this;t.magnificPopup.open({items:{src:i.image},type:"image",removalDelay:300,mainClass:"mfp-fade",callbacks:{beforeClose:function(){e.hide()}}});var a=i.zoom?parseFloat(i.zoom):f.o.maxscale;f.o.zoom&&f.moveTo(i.x,i.y,a,600)},this.hide=function(){this.location=null,f.hideLocation(),f.o.zoom&&!f.o.zoomoutclose||f.moveTo(.5,.5,f.fitscale,400)}}function o(){this.el=null,this.pin=null,this.shift=6,this.hovertipdesc=!1,this.init=function(){var i=this;return this.el=t("<div></div>").addClass("mapplic-tooltip mapplic-hovertip"),this.wrap=t("<div></div>").addClass("mapplic-tooltip-wrap").appendTo(this.el),this.title=t("<h4></h4>").addClass("mapplic-tooltip-title").appendTo(this.wrap),this.hovertipdesc&&(this.desc=t("<div></div>").addClass("mapplic-tooltip-description").appendTo(this.wrap)),this.triangle=t("<div></div>").addClass("mapplic-tooltip-triangle").appendTo(this.wrap),t(f.map).on("mouseover",".mapplic-layer a",(function(){var e="";t(this).hasClass("mapplic-pin")?(e=t(this).data("location"),i.pin=t('.mapplic-pin[data-location="'+e+'"]'),i.shift=Math.abs(parseFloat(i.pin.css("margin-top")))+20):(e=t(this).attr("xlink:href").slice(1),i.shift=20);var a=f.l[e];a&&a.title&&i.show(a)})).on("mouseout",(function(){i.hide()})),f.o.selector&&t(f.map).on("mouseover",f.o.selector,(function(){var e=f.l[t(this).attr("id")];i.shift=20,e&&e.title&&i.show(e)})).on("mouseout",(function(){i.hide()})),f.map.append(this.el),this},this.show=function(t){f.location!=t&&(this.title.text(t.title),this.hovertipdesc&&this.desc.html(t.description),this.position(t),this.el.stop().fadeIn(100))},this.position=function(t){t&&(this.el.css({left:100*t.x+"%",top:100*t.y+"%"}),this.drop=this.el.outerHeight()+this.shift)},this.hide=function(){this.el.stop().fadeOut(200)}}function l(){this.param="location",this.init=function(){var t=this;this.check(0),window.onpopstate=function(i){return i.state&&t.check(600),!1}},this.check=function(t){var i=this.getUrlParam(this.param);i&&f.showLocation(i,t,!0)},this.getUrlParam=function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+t+"=([^&#]*)"),e=i.exec(location.search);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))},this.update=function(t){var i;void 0!==window.URL?(i=new URL(window.location.href),i.searchParams.set(this.param,t),i=i.href):i=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+this.param+"="+t,window.history.pushState({path:i},"",i)},this.clear=function(){var t;void 0!==window.URL?(t=new URL(window.location.href),t.searchParams.delete(this.param),t=t.href):t=window.location.pathname,history.pushState("",document.title,t)}}function n(){this.param="location",this.init=function(){var i=this;this.check(0),t(window).on("hashchange",(function(){i.check(600)}))},this.check=function(t){var i=location.hash.slice(this.param.length+2);f.showLocation(i,t,!0)},this.update=function(t){window.location.hash=this.param+"-"+t},this.clear=function(){window.location.hash=this.param}}function s(){this.el=null,this.opacity=null,this.init=function(){return this.el=t("<div></div>").addClass("mapplic-minimap").appendTo(f.container.el),this.el.click((function(i){i.preventDefault();var e=(i.pageX-t(this).offset().left)/t(this).width(),a=(i.pageY-t(this).offset().top)/t(this).height();f.moveTo(e,a,f.scale/f.fitscale,100)})),this},this.addLayer=function(i){var e=t("<div></div>").addClass("mapplic-minimap-layer").attr("data-floor",i.id).appendTo(this.el),a=this;t("<img>").attr("src",i.minimap).addClass("mapplic-minimap-background").appendTo(e),t("<div></div>").addClass("mapplic-minimap-overlay").appendTo(e),t("<img>").attr("src",i.minimap).addClass("mapplic-minimap-active").on("load",(function(){a.update()})).appendTo(e)},this.show=function(i){t(".mapplic-minimap-layer",this.el).hide(),t('.mapplic-minimap-layer[data-floor="'+i+'"]',this.el).show()},this.update=function(i,e){var a=t(".mapplic-minimap-active",this.el);void 0===i&&(i=f.x),void 0===e&&(e=f.y);var o=f.container.el.width()/f.contentWidth/f.scale*this.el.width(),l=f.container.el.height()/f.contentHeight/f.scale*this.el.height(),n=-e/f.contentHeight/f.scale*this.el.height(),s=-i/f.contentWidth/f.scale*this.el.width(),c=s+o,p=n+l;a.each((function(){t(this)[0].style.clip="rect("+n+"px, "+c+"px, "+p+"px, "+s+"px)"}));var r=this;this.el.show(),this.el.css("opacity",1),clearTimeout(this.opacity),this.opacity=setTimeout((function(){r.el.css("opacity",0),setTimeout((function(){r.el.hide()}),600)}),2e3)}}function c(){this.el=null,this.nr=0,this.init=function(){return this.el=t("<div></div>").addClass("mapplic-legend"),this},this.build=function(i){var e=this;t.each(i,(function(t,i){"true"==i.legend&&e.add(i)})),this.nr>0&&this.el.appendTo(f.container.el)},this.add=function(i){var e=this.newToggle(i,!0);if(e)e.appendTo(this.el);else{var a=t("<span></span>").addClass("mapplic-legend-key");i.color&&a.css("background-color",i.color),t("<span></span>").addClass("mapplic-legend-label").text(i.title).prepend(a).appendTo(this.el)}this.nr++},this.toggle=function(i,e){t('*[id="'+i+'"]',f.map).toggle(e),t('*[data-category*="'+i+'"]',f.map).each((function(){var a=t(this).attr("data-category");if(a==i)t(this).toggle(e);else{var o=a.split(","),l=!1;o.forEach((function(i){t('.mapplic-toggle > input[data-group="'+i+'"]')[0].checked&&(l=!0)})),t(this).toggle(l)}}))},this.newToggle=function(i,e){var a=this,o=null;if("true"==i.toggle){o=t('<label class="mapplic-toggle"></label>');var l=t('<input type="checkbox" checked>').attr("data-group",i.id).appendTo(o),n=t("<span></span>").addClass("mapplic-toggle-circle").appendTo(o);e&&t("<span></span>").addClass("mapplic-legend-label").text(i.title).appendTo(o),i.color&&n.css("background-color",i.color),"true"==i.switchoff&&l.prop("checked",!1),l.change((function(){t('.mapplic-toggle > input[data-group="'+i.id+'"]',f.el).prop("checked",this.checked),a.toggle(i.id,this.checked)}))}return o},this.applyToggles=function(){var i=this;t(".mapplic-toggle > input",f.el).each((function(){i.toggle(t(this).attr("data-group"),this.checked)}))}}function p(){this.el=null,this.g={},this.filter=null,this.input=null,this.list=null,this.tags=null,this.taglist={},this.init=function(){var i=this;this.el=t("<div></div>").addClass("mapplic-sidebar").appendTo(f.el),this.filter=t("<div></div>").addClass("mapplic-filter").appendTo(this.el),this.tags=t("<div></div>").addClass("mapplic-filter-tags").appendTo(this.filter),this.input=t("<input>").attr({type:"text",spellcheck:"false",placeholder:f.loc.search}).addClass("mapplic-search-input").keyup((function(e){i.search(),13==e.keyCode&&t("li > a",i.el).filter(":visible:first").click()})),f.o.search&&this.input.prependTo(this.filter),f.clear=t("<a></a>").attr("href","#").addClass("mapplic-search-clear").click((function(t){t.preventDefault(),i.input.val(""),i.search()})).appendTo(this.filter);var e=t("<div></div>").addClass("mapplic-list-container").appendTo(this.el);this.list=t("<ol></ol>").addClass("mapplic-list").appendTo(e),f.o.search||this.el.addClass("mapplic-sidebar-nosearch")},this.addTag=function(i){var e=this;if(e.taglist[i.id])return!1;var a=t("<div></div>").addClass("mapplic-tag").text(i.title).appendTo(this.tags);t("<span></span>").appendTo(a),i.color&&a.css("background-color",i.color),a.click((function(){a.remove(),delete e.taglist[i.id],e.search()})).appendTo(a),e.taglist[i.id]=!0,e.search()},this.placeholder=function(i){var e="";if(i){var a=i.split(" ");a[0]&&(e+=a[0][0]),a[1]&&(e+=a[1][0])}return t("<div></div>").addClass("mapplic-thumbnail mapplic-thumbnail-placeholder").text(e.toUpperCase())},this.addCategories=function(i){var e=this,a=t("<li></li>").addClass("mapplic-list-expandable"),o=t("<ol></ol>").appendTo(a);this.list.append(a),i&&t.each(i,(function(i,a){if(f.g[a.id]=a,a.nr=0,"true"!=a.hide){var l=t("<li></li>").addClass("mapplic-list-category").attr("data-category",a.id),n=t("<a></a>").attr("href","#").prependTo(l),s=null;s=a.icon?t("<img>").attr("src",a.icon).addClass("mapplic-thumbnail").appendTo(n):e.placeholder(a.title).appendTo(n),a.color&&s.css("background-color",a.color);var c=t("<h4></h4").text(a.title).appendTo(n);a.about||c.addClass("mapplic-margin"),a.count=t("<span></span>").text("(0)").addClass("mapplic-list-count").appendTo(c),a.about&&t("<span></span>").addClass("mapplic-about").html(a.about).appendTo(n);var p=f.legend.newToggle(a);p&&p.appendTo(l),n.on("click",(function(i){i.preventDefault(),a.nr<1&&p?t("> input",p).trigger("click"):(e.input.val(""),e.addTag(a))})),a.list=l,l.appendTo(o)}}))},this.countCategory=function(){t.each(f.g,(function(t,i){i.count&&(i.count.text("("+i.nr+")"),i.nr<1?i.count.hide():i.count.show())}))},this.addLocation=function(i){var e=t("<li></li>").addClass("mapplic-list-location").attr("data-location",i.id),a=t("<a></a>").attr("href","#").click((function(e){e.preventDefault(),f.showLocation(i.id,600),t(window).width()<668&&"lightbox"!=(i.action||f.o.action)&&t("html, body").animate({scrollTop:f.container.el.offset().top},400)})).appendTo(e),o=b(i);if(o&&e.css("border-color",o),f.o.hidenofilter&&e.hide(),i.thumbnail?t("<img>").attr("src",i.thumbnail).addClass("mapplic-thumbnail").appendTo(a):f.o.thumbholder&&this.placeholder(i.title).appendTo(a),t("<h4></h4>").text(i.title).appendTo(a),t("<span></span>").html(i.about).addClass("mapplic-about").appendTo(a),i.category){i.category.toString().split(",").forEach((function(t){f.g[t]&&f.g[t].nr++}))}return this.list.append(e),e},this.search=function(){var i=this.input.val(),e=this;i?f.clear.fadeIn(100):f.clear.fadeOut(100),t.each(f.g,(function(a,o){if(o.list){var l=!1;t.isEmptyObject(e.taglist)?t.each(f.o.searchfields,(function(t,e){o[e]&&!l&&(l=!(-1==o[e].toLowerCase().indexOf(i.toLowerCase())))})):l=!1,l?o.list.slideDown(200):o.list.slideUp(200)}})),t.each(f.l,(function(a,o){if(o.list){var l=!1;f.o.hidenofilter&&t.isEmptyObject(e.taglist)&&!i||(t.each(f.o.searchfields,(function(t,e){o[e]&&!l&&(l=!(-1==o[e].toLowerCase().indexOf(i.toLowerCase())))})),t.each(e.taglist,(function(t,i){o.category&&-1!=o.category.indexOf(t)||(l=!1)}))),l?o.list.slideDown(200):o.list.slideUp(200)}}))},this.sort=function(){var i=this,e=this.list.children(".mapplic-list-location").get();e.sort((function(i,e){var a=t(i).text().toUpperCase(),o=t(e).text().toUpperCase();return a<o?-1:a>o?1:0})),t.each(e,(function(t,e){i.list.append(e)}))}}function r(){this.el=null,this.init=function(){return this.el=t("<div></div>").addClass("mapplic-coordinates").appendTo(f.container.el),this.el.append("x: "),t("<code></code>").addClass("mapplic-coordinates-x").appendTo(this.el),this.el.append(" y: "),t("<code></code>").addClass("mapplic-coordinates-y").appendTo(this.el),t('<input type="text"/>').addClass("coords").appendTo(this.el),t(".mapplic-layer",f.map).on("mousemove",(function(i){var e=(i.pageX-f.map.offset().left)/f.map.width()+.03,a=(i.pageY-f.map.offset().top)/f.map.height()+.05;t(".mapplic-coordinates-x").text(parseFloat(e).toFixed(4)),t(".mapplic-coordinates-y").text(parseFloat(a).toFixed(4)),t(".coords").val('x: "'+parseFloat(e).toFixed(4)+'", y: "'+parseFloat(a).toFixed(4)+'"')})),this}}function d(){this.el=null,this.init=function(){return this.el=t("<a></a>").attr("href","#").addClass("mapplic-button mapplic-clear-button").appendTo(f.container.el),f.o.zoombuttons||this.el.css("bottom","0"),this.el.on("click touchstart",(function(t){t.preventDefault(),f.hideLocation(),f.moveTo(.5,.5,f.fitscale,400)})),this},this.update=function(t){t==f.fitscale?this.el.stop().fadeOut(200):this.el.stop().fadeIn(200)}}function h(){this.el=null,this.init=function(){return this.el=t("<div></div>").addClass("mapplic-zoom-buttons").appendTo(f.container.el),this.zoomin=t("<a></ha>").attr("href","#").addClass("mapplic-button mapplic-zoomin-button").appendTo(this.el),this.zoomin.on("click touchstart",(function(t){t.preventDefault(),f.container.stopMomentum();var i=f.scale;f.scale=T(i+.8*i),f.x=C(f.x-(f.container.el.width()/2-f.x)*(f.scale/i-1)),f.y=k(f.y-(f.container.el.height()/2-f.y)*(f.scale/i-1)),z(f.x,f.y,f.scale,400,"ease")})),this.zoomout=t("<a></ha>").attr("href","#").addClass("mapplic-button mapplic-zoomout-button").appendTo(this.el),this.zoomout.on("click touchstart",(function(t){t.preventDefault(),f.container.stopMomentum();var i=f.scale;f.scale=T(i-.4*i),f.x=C(f.x-(f.container.el.width()/2-f.x)*(f.scale/i-1)),f.y=k(f.y-(f.container.el.height()/2-f.y)*(f.scale/i-1)),z(f.x,f.y,f.scale,400,"ease")})),this},this.update=function(t){this.zoomin.removeClass("mapplic-disabled"),this.zoomout.removeClass("mapplic-disabled"),t==f.fitscale?this.zoomout.addClass("mapplic-disabled"):t==f.o.maxscale&&this.zoomin.addClass("mapplic-disabled")}}function m(){this.el=null,this.init=function(){this.el=t("<a></a>").attr("href","#").attr("href","#").addClass("mapplic-button mapplic-fullscreen-button").click((function(i){i.preventDefault(),f.el.toggleClass("mapplic-fullscreen"),t(document).resize()})).appendTo(f.container.el),t(document).keyup((function(i){27===i.keyCode&&t(".mapplic-fullscreen")[0]&&(t(".mapplic-element.mapplic-fullscreen").removeClass("mapplic-fullscreen"),t(document).resize())}))}}function u(){this.el=null,this.oldW=0,this.oldH=0,this.position={x:0,y:0},this.momentum=null,this.init=function(){return this.el=t("<div></div>").addClass("mapplic-container").appendTo(f.el),f.map=t("<div></div>").addClass("mapplic-map").appendTo(this.el),f.map.css({width:f.contentWidth,height:f.contentHeight}),this},this.calcHeight=function(i){var e=i.toString().replace("px","");return"auto"==e&&f.container.el?e=f.container.el.width()*f.contentHeight/f.contentWidth:"%"==e.slice(-1)&&(e=t(window).height()*e.replace("%","")/100),!!t.isNumeric(e)&&e},this.resetZoom=function(){var t=f.l.init;if(t){var i=t.zoom?parseFloat(t.zoom):f.o.maxscale;f.switchLevel(t.level),f.moveTo(t.x,t.y,i,0)}else f.moveTo(.5,.5,f.fitscale,0)},this.revealChild=function(i){t(".mapplic-pin[data-location^="+i.id+"]",f.map).addClass("mapplic-revealed"),t("[id^="+i.id+"]",f.map).addClass("mapplic-revealed")},this.revealZoom=function(i){t(".mapplic-pin[data-reveal]",f.map).each((function(){var e=t(this).data("reveal");i>=e?t(this).addClass("mapplic-revealed"):t(this).removeClass("mapplic-revealed")}))},this.coverAll=function(){t(".mapplic-revealed",f.map).removeClass("mapplic-revealed")},this.stopMomentum=function(){cancelAnimationFrame(this.momentum),null!=this.momentum&&(f.x=this.position.x,f.y=this.position.y),this.momentum=null},this.addControls=function(){f.map.addClass("mapplic-zoomable"),document.ondragstart=function(){return!1};var i={x:0,y:0},e={x:this.position.x,y:this.position.y},a={x:0,y:0},o=this,l=function(){o.momentum=requestAnimationFrame(l),f.map.hasClass("mapplic-dragging")?(e.x=o.position.x,e.y=o.position.y,o.position.x=i.x,o.position.y=i.y,a.x=o.position.x-e.x,a.y=o.position.y-e.y):(o.position.x+=a.x,o.position.y+=a.y,a.x*=.85,a.y*=.85,Math.abs(a.x)+Math.abs(a.y)<.1&&(o.stopMomentum(),f.x=o.position.x,f.y=o.position.y)),o.position.x=C(o.position.x),o.position.y=k(o.position.y),z(o.position.x,o.position.y)};t(".mapplic-map-image",f.map).on("mousedown",(function(e){f.dragging=!1,f.map.addClass("mapplic-dragging");var a={x:e.pageX,y:e.pageY};o.stopMomentum(),i.x=C(e.pageX-a.x+f.x),i.y=k(e.pageY-a.y+f.y),l(),f.map.on("mousemove",(function(t){f.dragging=!0,i.x=C(t.pageX-a.x+f.x),i.y=k(t.pageY-a.y+f.y)})),t(document).on("mouseup",(function(){f.map.off("mousemove"),t(document).off("mouseup"),f.map.removeClass("mapplic-dragging")}))})),f.o.mousewheel&&t(".mapplic-layer",f.el).bind("mousewheel DOMMouseScroll",(function(t,i){t.preventDefault(),o.stopMomentum();var e=f.scale;f.scale=T(e+e*i/5),f.x=C(f.x-(t.pageX-f.container.el.offset().left-f.x)*(f.scale/e-1)),f.y=k(f.y-(t.pageY-f.container.el.offset().top-f.y)*(f.scale/e-1)),z(f.x,f.y,f.scale,200,"ease")}));var n=null,s=null,c=0,p=null;t(".mapplic-map-image",f.map).on("touchstart",(function(e){e.preventDefault();var a=e.originalEvent;1==a.touches.length&&(f.touchTime=(new Date).getTime(),f.dragging=!1,f.map.addClass("mapplic-dragging"),o.stopMomentum(),n={x:a.touches[0].pageX-f.x,y:a.touches[0].pageY-f.y},i.x=C(a.touches[0].pageX-n.x),i.y=k(a.touches[0].pageY-n.y),l(),f.map.on("touchmove",(function(t){t.preventDefault(),f.dragging=!0;var e=t.originalEvent;1==e.touches.length&&(i.x=C(e.touches[0].pageX-n.x),i.y=k(e.touches[0].pageY-n.y))})),t(document).on("touchend",(function(i){i.preventDefault(),t(document).off("touchend"),f.map.off("touchmove"),f.map.removeClass("mapplic-dragging")})))})),t(".mapplic-map-image",f.map).on("touchstart",(function(i){i.preventDefault();var e=i.originalEvent;2==e.touches.length&&(f.dragging=!1,f.map.addClass("mapplic-dragging"),o.stopMomentum(),n={x:e.touches[0].pageX-f.x,y:e.touches[0].pageY-f.y},s={x:e.touches[1].pageX-f.x,y:e.touches[1].pageY-f.y},c=Math.sqrt(Math.pow(n.x-s.x,2)+Math.pow(n.y-s.y,2)),p=f.scale,f.map.off("touchmove"),f.map.on("touchmove",(function(t){t.preventDefault(),f.dragging=!0;var i=t.originalEvent,e=(i.touches.length,{x:(i.touches[0].pageX+i.touches[1].pageX)/2,y:(i.touches[0].pageY+i.touches[1].pageY)/2}),a=Math.sqrt(Math.pow(i.touches[0].pageX-i.touches[1].pageX,2)+Math.pow(i.touches[0].pageY-i.touches[1].pageY,2))/c,o=f.scale;f.scale=T(p*a),f.x=C(f.x-(e.x-f.container.el.offset().left-f.x)*(f.scale/o-1)),f.y=k(f.y-(e.y-f.container.el.offset().top-f.y)*(f.scale/o-1)),z(f.x,f.y,f.scale,0,"ease")})),t(document).on("touchend",(function(i){t(document).off("touchend"),f.map.off("touchmove"),f.map.removeClass("mapplic-dragging")})))}))}}var f=this;f.o={source:"locations.json",selector:"[id^=landmark] > *, svg > #items > *",csv:!1,landmark:!1,height:420,portrait:668,minimap:!1,sidebar:!0,hidenofilter:!1,search:!0,searchfields:["title","about"],thumbholder:!1,deeplinking:!0,clearbutton:!0,zoombuttons:!0,zoomoutclose:!1,closezoomout:!0,action:"default",linknewtab:!1,lightbox:!0,hovertip:!0,marker:"default",fillcolor:null,fullscreen:!0,mousewheel:!0,autopopulate:!1,alphabetic:!1,maxscale:3,zoom:!0,zoommargin:200,mapfill:!1,developer:!1},f.loc={more:"More",search:"Search"},f.el=i,f.init=function(i){f.o=t.extend(f.o,i),"undefined"!=typeof mapplic_localization&&(f.loc=t.extend(f.loc,mapplic_localization)),f.el.addClass("mapplic-element mapplic-loading");f.el.data("mapdata");return f.el.data("mapdata")?(f.el.removeAttr("data-mapdata"),g(f.el.data("mapdata")),f.el.removeClass("mapplic-loading")):"string"==typeof f.o.source?t.getJSON(f.o.source,(function(t){g(t),f.el.removeClass("mapplic-loading")})).fail((function(){console.error("Couldn't load map data. (Make sure to run the script through web server)"),f.el.removeClass("mapplic-loading").addClass("mapplic-error"),alert("Data file missing or invalid!\nMake sure to run the script through web server.")})):(g(f.o.source),f.el.removeClass("mapplic-loading")),f};var g=function(i){f.data=i,f.g={},f.l={};var g=null;f.o=t.extend(f.o,i),f.o.zoommargin=parseFloat(f.o.zoommargin),f.o.maxscale=parseFloat(f.o.maxscale),f.el.data("height")&&(f.o.height=f.el.data("height")),f.contentWidth=parseFloat(i.mapwidth),f.contentHeight=parseFloat(i.mapheight),f.container=(new u).init(),f.levelselect=t("<div></div>").addClass("mapplic-levels-select"),f.o.minimap&&(f.minimap=(new s).init()),f.legend=(new c).init(),f.legend.build(i.groups||i.categories),f.o.sidebar?(f.sidebar=new p,f.sidebar.init(),f.sidebar.addCategories(i.groups||i.categories)):f.container.el.css("width","100%"),f.el.trigger("mapstart",f);var w=0,x=0;if(i.levels&&t.each(i.levels,(function(i,e){var a=e.map,o=a.substr(a.lastIndexOf(".")+1).toLowerCase(),l=t("<div></div>").addClass("mapplic-layer").attr("data-floor",e.id).hide().appendTo(f.map);switch(o){case"jpg":case"jpeg":case"png":case"gif":t("<img>").attr("src",a).addClass("mapplic-map-image").appendTo(l),f.addLocations(e.locations,e.id);break;case"svg":x++,t("<div></div>").addClass("mapplic-map-image").load(a,(function(){if(f.addLocations(e.locations,e.id),t(f.o.selector,this).on("click touchend",(function(){var i=(new Date).getTime()-f.touchTime;(!f.dragging||navigator.userAgent.toLowerCase().indexOf("android")>-1&&i<130)&&f.showLocation(t(this).attr("id"),600)})),f.o.autopopulate){var i=[];t(f.o.selector,this).each((function(){var e=t(this).attr("id"),a=f.l[e];a||(a={id:e,title:e.charAt(0).toUpperCase()+e.slice(1),pin:"hidden"},i.push(a))})),f.addLocations(i,e.id)}t("svg a",this).each((function(){var i=f.l[t(this).attr("xlink:href").substr(1)];i&&(t(this).attr("class","mapplic-clickable"),i.el=t(this))})),t("svg a",this).click((function(i){var e=t(this).attr("xlink:href").substr(1);f.showLocation(e,600),i.preventDefault()})),f.deeplinking&&f.deeplinking.check(0),f.el.trigger("svgloaded",[this,e.id]),0==--x&&v()})).appendTo(l);break;default:alert("File type "+o+" is not supported!")}f.minimap&&f.minimap.addLayer(e),f.levelselect.append(t("<button></button>").addClass("btn btn-sm levels-btn").attr("value",e.id).text(e.title)),g&&!e.show||(g=e.id),w++})),f.tooltip=(new e).init(),f.o.lightbox&&t.magnificPopup&&(f.lightbox=(new a).init()),f.o.hovertip&&(f.hovertip=(new o).init()),f.o.clearbutton&&(f.clearbutton=(new d).init()),f.o.zoombuttons&&(f.zoombuttons=(new h).init()),f.o.fullscreen&&(f.fullscreen=(new m).init()),f.o.developer&&(f.devtools=(new r).init()),w>1){f.levels=t("<div></div>").addClass("mapplic-levels");var y=t('<a href="#"></a>').addClass("d-none mapplic-levels-up").appendTo(f.levels);f.levelselect.appendTo(f.levels);var b=t('<a href="#"></a>').addClass("d-none mapplic-levels-down").appendTo(f.levels);f.container.el.append(f.levels),t("button",f.levelselect).click((function(){var i=t(this).val();f.switchLevel(i)})),y.click((function(i){i.preventDefault(),t(this).hasClass("mapplic-disabled")||f.switchLevel("+")})),b.click((function(i){i.preventDefault(),t(this).hasClass("mapplic-disabled")||f.switchLevel("-")}))}f.switchLevel(g),"true"===f.o.portrait&&(f.o.portrait=!0),t(window).resize((function(){if(1==f.o.portrait||t.isNumeric(f.o.portrait)&&t(window).width()<parseFloat(f.o.portrait))if(f.el.addClass("mapplic-portrait"),f.el.hasClass("mapplic-fullscreen"))f.container.el.height(t(window).height());else{var i=Math.min(Math.max(f.container.el.width()*f.contentHeight/f.contentWidth,2*t(window).height()/3),t(window).height()-66);f.container.el.height(i)}else f.el.removeClass("mapplic-portrait"),f.container.el.height("100%"),f.el.height(f.container.calcHeight(f.o.height));var e=f.container.el.width()/f.contentWidth,a=f.container.el.height()/f.contentHeight;f.o.mapfill?f.fitscale=e>a?e:a:f.fitscale=e<a?e:a,f.container.oldW==f.container.el.width()&&f.container.oldH==f.container.el.height()||(f.container.oldW=f.container.el.width(),f.container.oldH=f.container.el.height(),f.container.resetZoom(),f.tooltip.limitSize())})).resize(),f.o.deeplinking&&(history.pushState&&"function"==typeof URL?f.deeplinking=new l:f.deeplinking=new n,f.deeplinking.init()),0==x&&v(),f.o.zoom&&f.container.addControls(),t(document).on("click",".mapplic-location",(function(i){i.preventDefault(),f.showLocation(t(this).attr("href").substr(1),400),t("html, body").animate({scrollTop:f.container.el.offset().top},400)}))},v=function(){f.el.trigger("mapready",f),f.o.alphabetic&&f.sidebar&&f.sidebar.sort(),f.legend.applyToggles(),f.o.csv&&Papa.parse(f.o.csv,{header:!0,download:!0,encoding:"UTF-8",skipEmptyLines:!0,complete:function(t,i){f.addLocations(t.data)}}),f.container.resetZoom(),f.deeplinking&&f.deeplinking.check(0),f.el.data("landmark")&&(f.o.landmark=f.el.data("landmark")),f.o.landmark&&(f.o.sidebar=!1,f.o.zoombuttons=!1,f.o.deeplinking=!1,f.showLocation(f.o.landmark,0))},w=function(t,i){var e=f.data.rightLng-f.data.leftLng,a=f.data.bottomLat*Math.PI/180,o=f.data.mapwidth/e*360/(2*Math.PI),l=o/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)));return t=t*Math.PI/180,{x:(i-f.data.leftLng)*(f.data.mapwidth/e)/f.data.mapwidth,y:(f.data.mapheight-(o/2*Math.log((1+Math.sin(t))/(1-Math.sin(t)))-l))/f.data.mapheight}},x=function(t){if(!(t&&t[0]instanceof SVGElement))return!1;var i=t[0].getBBox(),e=f.container.el.width()/(i.width+40),a=f.container.el.height()/(i.height+40);return{x:(i.x+i.width/2)/f.contentWidth,y:(i.y+i.height/2)/f.contentHeight,scale:Math.min(e,a)}},y=function(t){var i=x(t);return!!i&&(f.moveTo(i.x,i.y,i.scale,600),!0)},b=function(t){var i=!1;return t.category&&(i=t.category.toString().split(",")),t.fill?t.fill:f.g[i[0]]&&f.g[i[0]].color?f.g[i[0]].color:!!f.o.fillcolor&&f.o.fillcolor},C=function(t){var i=(f.container.el.width()-f.contentWidth*f.scale).toFixed(4);return i<0?t>f.o.zoommargin?t=f.o.zoommargin:t<i-f.o.zoommargin&&(t=i-f.o.zoommargin):t=i/2,t},k=function(t){var i=(f.container.el.height()-f.contentHeight*f.scale).toFixed(4);return i<0?t>f.o.zoommargin?t=f.o.zoommargin:t<i-f.o.zoommargin&&(t=i-f.o.zoommargin):t=i/2,t},T=function(t){return t<=f.fitscale?t=f.fitscale:t>f.o.maxscale&&(t=f.o.maxscale),clearTimeout(f.zoomTimeout),f.zoomTimeout=setTimeout((function(){f.zoombuttons&&f.zoombuttons.update(t),f.clearbutton&&f.clearbutton.update(t),t==f.fitscale&&(f.container.coverAll(),f.o.closezoomout&&f.hideLocation()),f.container.revealZoom(t)}),200),t},z=function(i,e,a,o){o=void 0!==o?o/1e3:0,f.map.css({transition:"transform "+o+"s",transform:"translate("+i.toFixed(3)+"px ,"+e.toFixed(3)+"px) scale("+f.scale.toFixed(3)+")"}),a&&(t(".mapplic-pin",f.map).css({transition:"opacity 0.2s, transform "+o+"s",transform:"scale("+1/f.scale+")"}),t(".mapplic-tooltip",f.map).css({transition:"transform 0.3s",transform:"scale("+1/f.scale+") translate(-50%, -100%)"})),f.minimap&&f.minimap.update(i,e),f.el.trigger("positionchanged",location)};f.switchLevel=function(i){switch(i){case"+":i=t("option:selected",f.levelselect).removeAttr("selected").prev().prop("selected","selected").val();break;case"-":i=t("option:selected",f.levelselect).removeAttr("selected").next().prop("selected","selected").val();break;default:t("button",f.selectLevel).removeClass("active"),t('button[value="'+i+'"]',f.levelselect).addClass("active")}if(i){var e=t('.mapplic-layer[data-floor="'+i+'"]',f.el);if(!e.is(":visible")){f.tooltip&&f.tooltip.hide(),t(".mapplic-layer:visible",f.map).hide(),e.show(),f.minimap&&f.minimap.show(i);var a=f.levelselect.get(0).selectedIndex,o=t(".mapplic-levels-up",f.el),l=t(".mapplic-levels-down",f.el);o.removeClass("mapplic-disabled"),l.removeClass("mapplic-disabled"),0==a?o.addClass("mapplic-disabled"):a==f.levelselect.get(0).length-1&&l.addClass("mapplic-disabled"),f.el.trigger("levelswitched",i)}}},f.moveTo=function(t,i,e,a,o){a=void 0!==a?a:400,o=void 0!==o?o:.5,e=void 0!==e?e:f.scale/f.fitscale,f.container.stopMomentum(),f.scale=T(e),f.x=C(.5*f.container.el.width()-f.scale*f.contentWidth*t),f.y=k(f.container.el.height()*o-f.scale*f.contentHeight*i),z(f.x,f.y,f.scale,a)},f.addLocations=function(i,e){t.each(i,(function(i,a){a.level||(a.level=e||f.data.levels[0].id),f.l[a.id]=a;var o=t('[id^=landmark] > *[id="'+a.id+'"]',f.map);if(o.length>0){o.attr("class","mapplic-clickable"),a.el=o;var l=null;a.fill?l=a.fill:f.o.fillcolor&&(l=f.o.fillcolor),l&&(o.css("fill",l),t("> *",o).css("fill",l))}if(a.lat&&a.lng){var n=w(a.lat,a.lng);a.x=n.x,a.y=n.y}if((!a.x||!a.y)&&o){var n=x(a.el);a.x=n.x,a.y=n.y}if(a.pin||(a.pin=f.o.marker),-1==a.pin.indexOf("hidden")){var s=t(".mapplic-layer[data-floor="+a.level+"]",f.el),c=t("<a></a>").attr("href","#").addClass("mapplic-pin").css({top:100*a.y+"%",left:100*a.x+"%"}).appendTo(s);c.on("click touchend",(function(t){t.preventDefault(),f.showLocation(a.id,600)})),a.label&&t("<span><span>"+a.label+"</span></span>").appendTo(c),a.fill&&c.css({"background-color":a.fill,"border-color":a.fill}),a.pin.indexOf("pin-image")>-1&&c.css("background-image","url("+a.thumbnail+")"),a.reveal&&c.attr("data-reveal",a.reveal).hide(),a.category&&(a.category=a.category.toString(),c.attr("data-category",a.category)),c.attr("data-location",a.id),a.el=c}a.el&&a.el.addClass(a.pin.replace("hidden","")),"reveal"==a.action&&t(".mapplic-pin[data-location^="+a.id+"]",f.map).hide(),f.sidebar&&"disabled"!=a.action&&"true"!=a.hide&&1!=a.hide&&(a.list=f.sidebar.addLocation(a))})),f.sidebar&&f.sidebar.countCategory()},f.getLocationData=function(t){return f.l[t]},f.showLocation=function(i,e,a){var o=f.location=f.l[i];if(!o)return!1;var l=o.action&&"default"!=o.action?o.action:f.o.action;if("disabled"==l)return!1;switch(l){case"open-link":return window.location.href=o.link,!1
;case"open-link-new-tab":return window.open(o.link),f.location=null,!1;case"select":return o.el&&(o.el.hasClass("mapplic-active")?(o.el.removeClass("mapplic-active"),o.list&&o.list.removeClass("mapplic-active")):(o.el.addClass("mapplic-active"),o.list&&o.list.addClass("mapplic-active"))),!1;case"none":o.zoom?parseFloat(o.zoom):f.o.maxscale;f.hideLocation(),f.switchLevel(o.level),y(o.el);break;case"reveal":o.zoom?parseFloat(o.zoom):f.o.maxscale;f.hideLocation(),f.switchLevel(o.level),f.container.revealChild(o),f.o.zoom&&y(o.el);break;case"lightbox":f.switchLevel(o.level),f.lightbox.show(o);break;case"image":f.switchLevel(o.level),f.lightbox.showImage(o);break;default:f.switchLevel(o.level),f.tooltip.show(o)}t(".mapplic-active",f.el).removeClass("mapplic-active"),o.el&&o.el.addClass("mapplic-active"),o.list&&o.list.addClass("mapplic-active"),f.deeplinking&&!a&&f.deeplinking.update(i),f.el.trigger("locationopened",o)},f.hideLocation=function(){t(".mapplic-active",f.el).removeClass("mapplic-active"),f.deeplinking&&f.deeplinking.clear(),f.tooltip&&f.tooltip.hide(),f.location=null,f.el.trigger("locationclosed")},f.updateLocation=function(t){var i=f.l[t];if(i.id==t&&i.el.is("a")){if(i.lat&&i.lng){var e=w(i.lat,i.lng);i.x=e.x,i.y=e.y}var a=100*i.y,o=100*i.x;i.el.css({top:a+"%",left:o+"%"})}}};t.fn.mapplic=function(e){return this.each((function(){var a=t(this);if(!a.data("mapplic")){var o=new i(a).init(e);a.data("mapplic",o)}}))}})(jQuery),jQuery(document).ready((function(t){t("[id^=mapplic-id]").mapplic()}));